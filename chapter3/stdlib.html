<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>The Standard Library - High Performance Programming</title>
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="Monash DeepNeuron&#x27;s High Performance Programming Curriculum">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <!-- MathJax -->
        <script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../home.html">Home</a></li><li class="chapter-item expanded affix "><div>Foreword</div></li><li class="chapter-item expanded "><a href="../chapter1/chapter1.html"><strong aria-hidden="true">1.</strong> Getting Started</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../chapter1/wsl.html"><strong aria-hidden="true">1.1.</strong> WSL</a></li><li class="chapter-item expanded "><a href="../chapter1/software.html"><strong aria-hidden="true">1.2.</strong> Installing Software</a></li><li class="chapter-item expanded "><a href="../chapter1/helloworld.html"><strong aria-hidden="true">1.3.</strong> Hello World</a></li><li class="chapter-item expanded "><a href="../chapter1/godbolt.html"><strong aria-hidden="true">1.4.</strong> Compiler Explorer</a></li><li class="chapter-item expanded "><a href="../chapter1/slides1.html"><strong aria-hidden="true">1.5.</strong> Slides</a></li></ol></li><li class="chapter-item expanded "><a href="../chapter2/chapter2.html"><strong aria-hidden="true">2.</strong> Basics of C++</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../chapter2/typesystem.html"><strong aria-hidden="true">2.1.</strong> The C++ Type System</a></li><li class="chapter-item expanded "><a href="../chapter2/types.html"><strong aria-hidden="true">2.2.</strong> Primitive Types</a></li><li class="chapter-item expanded "><a href="../chapter2/variables.html"><strong aria-hidden="true">2.3.</strong> Variables</a></li><li class="chapter-item expanded "><a href="../chapter2/operators.html"><strong aria-hidden="true">2.4.</strong> Operators</a></li><li class="chapter-item expanded "><a href="../chapter2/io.html"><strong aria-hidden="true">2.5.</strong> IO</a></li><li class="chapter-item expanded "><a href="../chapter2/eqordlogic.html"><strong aria-hidden="true">2.6.</strong> Equality, Ordering &amp; Logical Operators</a></li><li class="chapter-item expanded "><a href="../chapter2/condexpr.html"><strong aria-hidden="true">2.7.</strong> Conditional Expressions</a></li><li class="chapter-item expanded "><a href="../chapter2/loops.html"><strong aria-hidden="true">2.8.</strong> Loops</a></li><li class="chapter-item expanded "><a href="../chapter2/functions.html"><strong aria-hidden="true">2.9.</strong> Functions</a></li><li class="chapter-item expanded "><a href="../chapter2/slides2.html"><strong aria-hidden="true">2.10.</strong> Slides</a></li></ol></li><li class="chapter-item expanded "><a href="../chapter3/chapter3.html"><strong aria-hidden="true">3.</strong> Memory</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../chapter3/pointers.html"><strong aria-hidden="true">3.1.</strong> Pointers</a></li><li class="chapter-item expanded "><a href="../chapter3/slices.html"><strong aria-hidden="true">3.2.</strong> Slices</a></li><li class="chapter-item expanded "><a href="../chapter3/references.html"><strong aria-hidden="true">3.3.</strong> References</a></li><li class="chapter-item expanded "><a href="../chapter3/memory.html"><strong aria-hidden="true">3.4.</strong> Dynamic Memory</a></li><li class="chapter-item expanded "><a href="../chapter3/stdlib.html" class="active"><strong aria-hidden="true">3.5.</strong> The Standard Library</a></li><li class="chapter-item expanded "><a href="../chapter3/slides3.html"><strong aria-hidden="true">3.6.</strong> Slides</a></li></ol></li><li class="chapter-item expanded "><a href="../chapter4/chapter4.html"><strong aria-hidden="true">4.</strong> Intermediate C++ Features</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../chapter4/advfunc.html"><strong aria-hidden="true">4.1.</strong> Advanced Function Concepts</a></li><li class="chapter-item expanded "><a href="../chapter4/namespaces.html"><strong aria-hidden="true">4.2.</strong> Namespaces</a></li><li class="chapter-item expanded "><a href="../chapter4/enums.html"><strong aria-hidden="true">4.3.</strong> Enumerations</a></li><li class="chapter-item expanded "><a href="../chapter4/unions.html"><strong aria-hidden="true">4.4.</strong> Unions</a></li><li class="chapter-item expanded "><a href="../chapter4/structs.html"><strong aria-hidden="true">4.5.</strong> Structures</a></li><li class="chapter-item expanded "><a href="../chapter4/task1.html"><strong aria-hidden="true">4.6.</strong> Task 1</a></li><li class="chapter-item expanded "><a href="../chapter4/slides4.html"><strong aria-hidden="true">4.7.</strong> Slides</a></li></ol></li><li class="chapter-item expanded "><a href="../chapter5/chapter5.html"><strong aria-hidden="true">5.</strong> Generic Programming</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../chapter5/classes.html"><strong aria-hidden="true">5.1.</strong> Classes</a></li><li class="chapter-item expanded "><a href="../chapter5/templates.html"><strong aria-hidden="true">5.2.</strong> Templates</a></li><li class="chapter-item expanded "><a href="../chapter5/generics.html"><strong aria-hidden="true">5.3.</strong> Generics</a></li><li class="chapter-item expanded "><a href="../chapter5/concepts.html"><strong aria-hidden="true">5.4.</strong> Concepts</a></li><li class="chapter-item expanded "><a href="../chapter5/task2.html"><strong aria-hidden="true">5.5.</strong> Task 2</a></li><li class="chapter-item expanded "><a href="../chapter5/slides5.html"><strong aria-hidden="true">5.6.</strong> Slides</a></li></ol></li><li class="chapter-item expanded "><a href="../chapter6/chapter6.html"><strong aria-hidden="true">6.</strong> Algorithms &amp; Data Structures</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../chapter6/iterators.html"><strong aria-hidden="true">6.1.</strong> Iterators</a></li><li class="chapter-item expanded "><a href="../chapter6/data-structures.html"><strong aria-hidden="true">6.2.</strong> Data Structures</a></li><li class="chapter-item expanded "><a href="../chapter6/algorithms.html"><strong aria-hidden="true">6.3.</strong> Algorithms</a></li><li class="chapter-item expanded "><a href="../chapter6/ranges.html"><strong aria-hidden="true">6.4.</strong> Ranges</a></li><li class="chapter-item expanded "><a href="../chapter6/views.html"><strong aria-hidden="true">6.5.</strong> Views</a></li><li class="chapter-item expanded "><a href="../chapter6/task3.html"><strong aria-hidden="true">6.6.</strong> Task 3</a></li><li class="chapter-item expanded "><a href="../chapter6/slides6.html"><strong aria-hidden="true">6.7.</strong> Slides</a></li></ol></li><li class="chapter-item expanded "><a href="../chapter7/chapter7.html"><strong aria-hidden="true">7.</strong> Concurrent Computing</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../chapter7/parallel-alg.html"><strong aria-hidden="true">7.1.</strong> Parallel Algorithms</a></li><li class="chapter-item expanded "><a href="../chapter7/atomics.html"><strong aria-hidden="true">7.2.</strong> Atomics</a></li><li class="chapter-item expanded "><a href="../chapter7/threads.html"><strong aria-hidden="true">7.3.</strong> Threads</a></li><li class="chapter-item expanded "><a href="../chapter7/mutexes.html"><strong aria-hidden="true">7.4.</strong> Mutexes</a></li><li class="chapter-item expanded "><a href="../chapter7/async.html"><strong aria-hidden="true">7.5.</strong> Asynchronous Programming</a></li><li class="chapter-item expanded "><a href="../chapter7/slides7.html"><strong aria-hidden="true">7.6.</strong> Slides</a></li></ol></li><li class="chapter-item expanded "><a href="../GODBOLT.html">Godbolt Examples</a></li><li class="chapter-item expanded affix "><a href="../planned.html">Planned Additions</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">High Performance Programming</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/MonashDeepNeuron/HPP" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="introduction-to-the-standard-library"><a class="header" href="#introduction-to-the-standard-library">Introduction to the Standard Library</a></h1>
<h2 id="what-is-the-standard-library"><a class="header" href="#what-is-the-standard-library">What is the Standard Library</a></h2>
<p>The Standard Library is the full set of features in C++ that are available outside the pure language. These include mathematical functions, IO facilities, containers, algorithms and much more. These are tools that abstract a lot of the useful mechanics of C++ into safe, efficient and fast facilities that are easier to use, more consistent and far superior in functionality. The C++ Standard Library is included using headers. These are the files we have been importing using the <code>#include</code> preprocessor directive.</p>
<p>This week you will learn about the most useful and bare-bones features in the Standard Library that will make working with C++ much easier, more idiomatic and faster.</p>
<h2 id="initializer-lists"><a class="header" href="#initializer-lists">Initializer Lists</a></h2>
<p>Throughout the last few weeks we have been using <em>brace-init-lists</em> to initialise objects. This is super useful for <em>slice-like</em> types to be initialised without using for loops. In C++ these brace-init-lists are converted to <code>std::initializer_list&lt;T&gt;</code> (where <code>T</code> is the element type). This is a useful construct for building user-defined containers that are initialised using a brace-init-list. There is not much use for you in <code>std::initializer_list</code> now but it is useful to know about later. One important thing to know about <code>std::initializer_list</code> is that is is a construction only type. That is it is only used to create object, you cannot return a <code>std::initializer_list</code> from a function.</p>
<p><a href="https://en.cppreference.com/w/cpp/utility/initializer_list"><code>std::initializer_list</code></a></p>
<h2 id="arrays"><a class="header" href="#arrays">Arrays</a></h2>
<p>Slices are useful for packing contiguous data into a single object but because of the implicit nature of decaying into pointers they can be error prone. This is where C++'s array type come in.</p>
<p><code>std::array</code> comes in. This is a complete array type that store both its data and size. Like slices, <code>std::array</code> must know its type and size at compile time and the type must be the same throughout the array. Because <code>std::array</code> is a complete object you can use reference semantics on it in an intuitive way. It is highly recommended to use <code>std::array</code> instead of slices everywhere you can.</p>
<pre><code class="language-cxx">#include &lt;iostream&gt;
#include &lt;array&gt;

void print(std::array&lt;int, 6&gt; arr)
{
    std::cout &lt;&lt; &quot;[ &quot;;
    for (auto i {0}; i &lt; arr.size(); ++i)
        std::cout &lt;&lt; arr[i] &lt;&lt; &quot;, &quot;;
    std::cout &lt;&lt; &quot;]&quot; &lt;&lt; std::endl;
}

auto main () -&gt; int
{
    auto a = std::array&lt;int, 6&gt;{ 1, 2, 3, 4, 5, 6 };
    auto b = std::to_array&lt;int&gt;({ -1, -2, -3, -4, -5, -6});  ///&lt; Size can be deduced

    print(a);
    print(b);

    return 0;
}
</code></pre>
<p><a href="https://www.godbolt.org/z/dbcKqx53f">Example</a></p>
<p><a href="https://en.cppreference.com/w/cpp/container/array"><code>std::array</code></a></p>
<h2 id="member-access"><a class="header" href="#member-access">Member Access</a></h2>
<p>Because we are know looking at some custom types from C++'s standard library it is important to point out how to access member functions and variables of both objects and pointers. For an object <code>T t();</code> with a member variable you access it using the <code>.</code> operator like <code>t.foo</code>. If <code>t::foo</code> is a member function you postfix parentheses to call the function like <code>t.foo()</code>. If the object is a pointer say <code>T* tp = &amp;t</code> then the <code>-&gt;</code> operator is used instead of <code>.</code>.</p>
<h2 id="spans"><a class="header" href="#spans">Spans</a></h2>
<p>Another useful <em>slice-like</em> structure is a <code>std::span</code>. Remember the <code>print()</code> function (in slices section of this chapter) that took a slice and a size. This is common place in many old C and C++ libraries that used pointer for all buffers. <code>std::span</code> removes the need for pointers altogether. <code>std::span</code> is a non-owning view of any object that has some contiguous data and a size. This allows libraries to accept a multitude of different intpu types that resemble the shape and work seamlessly with them all.</p>
<pre><code class="language-cxx">#include &lt;array&gt;
#include &lt;iostream&gt;
#include &lt;span&gt;

void print(std::span&lt;int&gt; span)
{
    std::cout &lt;&lt; &quot;[ &quot;;
    for (auto&amp; e : span)
        std::cout &lt;&lt; e &lt;&lt; &quot;, &quot;;
    std::cout &lt;&lt; &quot;]&quot; &lt;&lt; std::endl;
}

auto main () -&gt; int
{
    auto array = std::to_array&lt;int&gt;({ 1, 2, 3, 4, 5, 6 });
    int slice[] = {4, 46, 57};

    print(array);
    print(slice);

    return 0;
}
</code></pre>
<p><a href="https://www.godbolt.org/z/4Yo93e7Tr">Example</a></p>
<p><a href="https://en.cppreference.com/w/cpp/container/span"><code>std::span</code></a></p>
<h2 id="strings"><a class="header" href="#strings">Strings</a></h2>
<p>Now that we have a much more powerful array type at out disposal it might be tempting to use it as a character array for strings and while this is viable we often want to form a very different set of operations on strings compared to arrays. For this we have <code>std::string</code>. <code>std::string</code> is a specialised type that has a much larger interface of string operations.</p>
<pre><code class="language-cxx">#include &lt;iostream&gt;
#include &lt;string&gt;

auto main () -&gt; int
{
    auto str1 {&quot;Hello&quot;};
    auto str2(&quot;Goodbye&quot;);
    
    std::cout &lt;&lt; str1 &lt;&lt; std::endl;
    std::cout &lt;&lt; str2 &lt;&lt; std::endl;

    return 0;
}
</code></pre>
<blockquote>
<p>Note: There are also string type for all of C++'s character types eg. <code>wchar_t</code>.</p>
</blockquote>
<p><a href="https://www.godbolt.org/z/hqT44PM7M">Example</a></p>
<p><a href="https://en.cppreference.com/w/cpp/string/basic_string"><code>std::string</code></a></p>
<h3 id="string-views"><a class="header" href="#string-views">String Views</a></h3>
<p>There are also span like views for strings. This is called <code>std::string_view</code>. Like span it doesn't own its string but can be used to access its value. This is designed to be a replacement for character slices.</p>
<pre><code class="language-cxx">#include &lt;iostream&gt;
#include &lt;string_view&gt;

void print(std::string_view s)
{ std::cout &lt;&lt; s &lt;&lt; std::endl; }

auto main () -&gt; int
{
    print(&quot;Hello&quot;);

    return 0;
}
</code></pre>
<p><a href="https://www.godbolt.org/z/cbb95YWWj">Example</a></p>
<p><a href="https://en.cppreference.com/w/cpp/string/basic_string_view"><code>std::string_view</code></a></p>
<h3 id="literal-operators"><a class="header" href="#literal-operators">Literal Operators</a></h3>
<p>In C++ the is a cool operator called the literal operator <code>&quot;&quot;</code>. This is used to construct literals from string literals. The are string literal operators for <code>std::string</code> and <code>std::string_view</code> which are <code>&quot;&quot;s</code> and <code>&quot;&quot;sv</code> respectively.</p>
<pre><code class="language-cxx">#include &lt;iostream&gt;
#include &lt;string&gt;
#include &lt;string_view&gt;

using namespace std::literals;

void print(std::string_view s)
{ std::cout &lt;&lt; s &lt;&lt; std::endl; }

auto main () -&gt; int
{
    print(&quot;Hello&quot;sv);

    std::cout &lt;&lt; typeid(&quot;Hello&quot;).name() &lt;&lt; std::endl;
    std::cout &lt;&lt; typeid(&quot;Hello&quot;s).name() &lt;&lt; std::endl;
    std::cout &lt;&lt; typeid(&quot;Hello&quot;sv).name() &lt;&lt; std::endl;

    return 0;
}
</code></pre>
<p><a href="https://www.godbolt.org/z/jcMfrG76c">Example</a></p>
<h2 id="smart-pointers"><a class="header" href="#smart-pointers">Smart Pointers</a></h2>
<p>The final facility we will look at is C++'s smart pointers. Smart pointers allow for automatic lifetime management of heap allocated memory resources. It is highly recommended to only use smart pointers for for any kind of head resource.</p>
<p>All smart pointers are in the <code>&lt;memory&gt;</code> header.</p>
<h3 id="unique-pointer"><a class="header" href="#unique-pointer">Unique Pointer</a></h3>
<p><code>std::unique_ptr</code> is a pointer to a uniquely owned resource. It cannot be copied, only moved. When a <code>std::unique_ptr</code> goes out of scope it automatically deletes the allocated resource. Because <code>std::unique_ptr</code> is a complete object you can pass a reference of a <code>std::unique_ptr</code> and modify the underlying value like a pointer. It also offers a safer <code>std::unique_ptr::get()</code> method that returns <code>nullptr</code> if the <code>std::unique_ptr</code> points to nothing.</p>
<pre><code class="language-cxx">#include &lt;iostream&gt;
#include &lt;memory&gt;

void print(std::unique_ptr&lt;int&gt;&amp; ptr)
{ 
    std::cout &lt;&lt; ptr &lt;&lt; std::endl;
    std::cout &lt;&lt; *ptr &lt;&lt; std::endl;
}

void add_magic(std::unique_ptr&lt;int&gt;&amp; ptr)
{ *ptr += 42; }

auto main () -&gt; int
{
    std::unique_ptr&lt;int&gt; p1(new int(6));
    auto p2 = std::make_unique&lt;int&gt;(7);
    auto p3 = std::unique_ptr&lt;int&gt;{nullptr};

    print(p1);
    print(p2);

    add_magic(p1);
    // add_magic(p3);  ///&lt; Would fail 

    print(p1);
    // print(p3);  ////&lt; Would fails

    return 0;
}
</code></pre>
<p><a href="https://www.godbolt.org/z/G1T1j84nE">Example</a></p>
<p><a href="https://en.cppreference.com/w/cpp/memory/unique_ptr"><code>std::unique_ptr</code></a></p>
<h3 id="shared-pointer"><a class="header" href="#shared-pointer">Shared Pointer</a></h3>
<p>Sometimes it useful to have multiple pointers refer to the same dynamic memory resource. However, one issue of this is there is know way to know if the memory resource is still needed but another pointer meaning a memory resource can be released accidently leaving all other pointers to the now deleted resource a dangling pointer. This is where <code>std::shared_ptr</code> comes in handy. This pointer will maintain a count or how many pointers refer to it. Only when this count reaches zero, indicating no more pointers are using the resource will the resource get deleted. This gives the behavior of many garbage collected languages without the massive overhead of a global gabage collecting program.</p>
<pre><code class="language-cxx">#include &lt;iostream&gt;
#include &lt;memory&gt;

void print(std::shared_ptr&lt;int&gt; ptr)
{ 
    std::cout &lt;&lt; &quot;ptr = &quot; &lt;&lt; ptr &lt;&lt; std::endl;
    std::cout &lt;&lt; &quot;*ptr = &quot; &lt;&lt; *ptr &lt;&lt; std::endl;
    std::cout &lt;&lt; &quot;ptr.use_count() = &quot; &lt;&lt; ptr.use_count() &lt;&lt; std::endl;
}

void add_magic(std::shared_ptr&lt;int&gt;&amp; ptr)
{ *ptr += 42; }

auto main () -&gt; int
{
    auto p = std::make_shared&lt;int&gt;(7);

    std::cout &lt;&lt; &quot;p.use_count() = &quot; &lt;&lt; p.use_count() &lt;&lt; std::endl;

    print(p);
    add_magic(p);

    return 0;
}
</code></pre>
<p><a href="https://www.godbolt.org/z/39dPYooTW">Example</a></p>
<p><a href="https://en.cppreference.com/w/cpp/memory/shared_ptr"><code>std::shared_ptr</code></a></p>
<h3 id="weak-pointer"><a class="header" href="#weak-pointer">Weak Pointer</a></h3>
<p>Sometimes it is useful to observe an existing resource that is managed by <code>std::shared_ptr</code> and only assume temporary ownership if the object still exists. This is where <code>std::weak_ptr</code> is used. It is constructed from an existing <code>std::shared_ptr</code> and observes the memory resource and is able to be converted to a <code>std::shared_ptr</code> when it needs to access the resource. This is useful for breaking reference cycles of <code>std::shared_ptr</code>'s and extend the lifetime of a memory resource to the scope of a <code>std::weak_ptr</code>. It is also able to check if the resource has been deleted already.</p>
<pre><code class="language-cxx">#include &lt;iostream&gt;
#include &lt;memory&gt;

void print(std::weak_ptr&lt;int&gt; ptr)
{ 
    std::cout &lt;&lt; &quot;ptr.use_count() = &quot; &lt;&lt; ptr.use_count() &lt;&lt; std::endl;

    if (auto sp = ptr.lock())
    {
        std::cout &lt;&lt; &quot;sp.use_count() = &quot; &lt;&lt; sp.use_count() &lt;&lt; std::endl;
        std::cout &lt;&lt; &quot;sp = &quot; &lt;&lt; sp &lt;&lt; std::endl;
        std::cout &lt;&lt; &quot;*sp = &quot; &lt;&lt; *sp &lt;&lt; std::endl;
    }
    else
        std::cout &lt;&lt; &quot;ptr is expired&quot; &lt;&lt; std::endl;
}

auto main () -&gt; int
{
    auto p = std::make_shared&lt;int&gt;(7);

    std::cout &lt;&lt; &quot;p.use_count() = &quot; &lt;&lt; p.use_count() &lt;&lt; std::endl;

    print(p);

    return 0;
}
</code></pre>
<p><a href="https://www.godbolt.org/z/PaonscnEG">Example</a></p>
<p><a href="https://en.cppreference.com/w/cpp/memory/weak_ptr"><code>std::weak_ptr</code></a></p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../chapter3/memory.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                            <a rel="next" href="../chapter3/slides3.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../chapter3/memory.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                    <a rel="next" href="../chapter3/slides3.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
    </body>
</html>
